{% extends "base.html" %}
{% block body %}
{% from 'macros.html' import render_pagination %}

<h1>{{ _('Pull Mirror %(mirror_name)s logs', mirror_name=pull_mirror.project_mirror) }}</h1>

<table class="table table-hover">
    <thead>
    <tr>
        <th>{{ _('Task ID') }}</th>
        <th>{{ _('Task name') }}</th>
        <th>{{ _('Invoked by') }}</th>
        <th>{{ _('Status') }}</th>
        <th>{{ _('Result') }}</th>
        <th>{{ _('Date done') }}</th>
        <th>{{ _('Traceback') }}</th>
        <th></th>
    </tr>
    </thead>
    <tbody>
    {% for task_result in pagination.items %}
    <tr class="{{task_result|format_task_status_class}}" title="{{ _('Task %(task_id)s', task_id=task_result.taskmeta.task_id) }}">
        <th scope="row">{{task_result.taskmeta.task_id}}</th>
        <td>{{task_result.task_name}}</td>
        <td>{{task_result.invoked_by|format_task_invoked_by}}</td>
        <td>{{task_result.taskmeta.status}}</td>
        <td>{{task_result.taskmeta.result}}</td>
        <td>{{task_result.taskmeta.date_done|format_datetime}}</td>
        <td>{{task_result.taskmeta.traceback}}</td>

        <td class="text-nowrap">
            <a class="btn btn-xs btn-primary" href="" title="{{ _('Detail') }}"><i class="fa fa-eye" aria-hidden="true"></i></a>
        </td>
    </tr>
    {% for task_result_children in task_result.children %}
    <tr class="{{task_result_children|format_task_status_class}}" title="{{ _('Task %(task_id)s', task_id=task_result_children.taskmeta.task_id) }}">
        <th scope="row"><i class="fa fa-arrow-right" title="{{_('Child of task %(parent_task_id)s', parent_task_id=task_result_children.parent.taskmeta.task_id)}}"></i> {{task_result_children.taskmeta.task_id}}</th>
        <td>{{task_result_children.task_name}}</td>
        <td>{{task_result_children.invoked_by|format_task_invoked_by}}</td>
        <td>{{task_result_children.taskmeta.status}}</td>
        <td>{{task_result_children.taskmeta.result}}</td>
        <td>{{task_result_children.taskmeta.date_done|format_datetime}}</td>
        <td>{{task_result_children.taskmeta.traceback}}</td>

        <td class="text-nowrap">
            <a class="btn btn-xs btn-primary" href="" title="{{ _('Detail') }}"><i class="fa fa-eye" aria-hidden="true"></i></a>
        </td>
    </tr>
    {% endfor %}
    {% endfor %}

    </tbody>
</table>

<div class="text-center">
{{render_pagination(pagination)}}
</div>
{% endblock %}
